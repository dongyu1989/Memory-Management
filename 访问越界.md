# Memory-Management

页式存储管理机制通过页面目录和页面表将每个线性地址（也可以理解为虚拟地址）转成物理地址。如果在这个过程中遇到某种阻碍使CPU无法最终访问到相应的物理内存单元，映射便失败了，当前的指令也就不能执行完成。此时CPU会产生一次页面错误（Page Fault）异常，进而执行预定的页面异常处理程序，使应用程序得以从因映射失败而暂停的指令处开始恢复执行，或进行一些善后处理。这里所说的阻碍可以有以下几种情况：

* 相应的页面目录或页面表项为空，也就是该线性地址与物理地址的映射关系尚未建立，或者已经撤销。
* 相应的物理页面不在内存中。
* 指令中规定的访问方式与页面的权限不符，例如企图打开一个“只读”的页面。

在这个情景里，我们假定一段用户曾经将一个已打开文件通过mmap()系统调用映射到内存，然后又已经将映射撤销(通过munmap系统调用)。在撤销一个映射区时，常常会在虚存地址空间中留下一个孤立的空洞，而相应的地址则不能继续使用了。但是，在用户程序中往往会有错误，以致在程序中某个地方还再次访问这个已经撤销的区域。这时候，一次因越界访问一个无效地址而引起映射失败，从而就产生一次页面出错异常。这里假定CPU的运行已经到达了页面异常服务程序的主体do_page_fault（）的入口：

![image](https://github.com/wangdongyu1989/Memory-Management/blob/master/images/%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%8420170405c.jpg "访问越界")
![image](https://github.com/wangdongyu1989/Memory-Management/blob/master/images/%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%8420170405d.jpg "访问越界")
